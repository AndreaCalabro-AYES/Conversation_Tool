# Use an ARM-compatible Python 3.8 image for Raspberry Pi 4
FROM arm32v7/python:3.8-slim-buster

# Set environment variables
ENV DEBIAN_FRONTEND=noninteractive

# Set the working directory inside the container
WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    build-essential \
    libatlas-base-dev \
    gfortran \
    libhdf5-dev \
    libc-ares-dev \
    libeigen3-dev \
    libopenblas-dev \
    libopenmpi-dev \
    liblapack-dev \
    wget \
    && apt-get clean

# Install TensorFlow 2.2.0 for ARM
RUN pip install tensorflow==2.2.0

# Install Rasa 3.5.10 and other Python dependencies
RUN pip install rasa==3.5.10 \
    nltk==3.8.1 \
    scikit-learn==1.1.3

# Copy the application code into the container
COPY . .

